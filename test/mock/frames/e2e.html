<!doctype html>
<html>
<head>
	<title>Message Iframe Fixture</title>
	<script src="../../../dist/axe.js"></script>
	<script>
		axe._load({ rules: [{
			id: 'html',
			selector: 'html',
			any: ['html']
		}],
		checks: [{
			id: 'html',
			evaluate: function () {
				return true;
			}
		}],
		tools: [{
			id: 'html',
			source: {
				run: function (node, options, callback) {
					if (node.nodeName !== 'A') {
						callback('nope!');
					}
					callback('result!');
				}
			}
		}],
		finders: [{
			id: 'html',
			source: {
				run: function (node, options, callback) {
					callback({
						href: node.getAttribute('href')
					});
				}
			}
		}],
		listeners : [{
			id: 'html',
			source: {
				run: function (options, callback) {
					var input;
					this.results = [];
					input = document.querySelector('input');
					if (input) {
						this.results = [{
							node: {
								element: input,
								source: '<html></html>',
								selector: [axe.utils.getSelector(input)]
							}
						}];
					}
					this.callback = callback;
				},
				end: function () {
					this.callback(this.results);
				},
				control: function (callback) {
					setTimeout(function () {
						callback();
					}, 500);
				}
			}
		}],
		messages: {}});
	</script>
</head>
<body>

	<input type="text">
	<a href="#">link</a>
</body>
</html>
